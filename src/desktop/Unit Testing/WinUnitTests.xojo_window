#tag DesktopWindow
Begin DesktopWindow WinUnitTests
   Backdrop        =   0
   BackgroundColor =   &cFFFFFF00
   Composite       =   False
   DefaultLocation =   0
   FullScreen      =   False
   HasBackgroundColor=   False
   HasCloseButton  =   True
   HasFullScreenButton=   False
   HasMaximizeButton=   True
   HasMinimizeButton=   True
   Height          =   914
   ImplicitInstance=   True
   MacProcID       =   0
   MaximumHeight   =   32000
   MaximumWidth    =   32000
   MenuBar         =   1919610602
   MenuBarVisible  =   True
   MinimumHeight   =   800
   MinimumWidth    =   1000
   Resizeable      =   True
   Title           =   "Markdown Unit Tests"
   Type            =   0
   Visible         =   True
   Width           =   1400
   Begin DesktopGroupBox GroupBoxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Overview"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   188
      Index           =   0
      InitialParent   =   ""
      Italic          =   False
      Left            =   286
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   0
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   14
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   1094
      Begin DesktopLabel Labels
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   1
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   295
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   0
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Start:"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   44
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   68
      End
      Begin DesktopLabel Labels
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   2
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   540
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   1
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Duration:"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   44
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   100
      End
      Begin DesktopLabel Labels
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   3
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   295
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   2
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Total:"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   76
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   68
      End
      Begin DesktopLabel Labels
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   4
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   295
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   3
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Passed:"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   108
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   68
      End
      Begin DesktopLabel Labels
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   5
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   295
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   4
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Failed:"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   140
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   68
      End
      Begin DesktopLabel Labels
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   6
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   295
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   5
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Skipped:"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   172
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   68
      End
      Begin DesktopLabel StartLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   375
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   6
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "1/1/2012 12:00PM"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   44
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   145
      End
      Begin DesktopLabel DurationLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   620
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   7
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "0s"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   44
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   137
      End
      Begin DesktopLabel TestCountLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   375
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   8
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "(run tests first)"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   76
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   382
      End
      Begin DesktopLabel PassedCountLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   375
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   9
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "0 (0%)"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   108
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   100
      End
      Begin DesktopLabel FailedCountLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   375
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   10
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "0 (0%)"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   140
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   100
      End
      Begin DesktopLabel SkippedCountLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   375
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   11
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "0 (0%)"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   172
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   100
      End
      Begin DesktopLabel Labels
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   8
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   540
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   12
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Not Implemented:"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   172
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   135
      End
      Begin DesktopLabel NotImplementedCountLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$0"
         Italic          =   False
         Left            =   680
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   13
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "0 (0%)"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   172
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   100
      End
   End
   Begin DesktopGroupBox GroupBoxes
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Selected Test Results"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   680
      Index           =   1
      InitialParent   =   ""
      Italic          =   False
      Left            =   286
      LockBottom      =   True
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   0
      TabIndex        =   5
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   214
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   1100
      Begin DesktopLabel TestNameLabel
         AllowAutoDeactivate=   True
         Bold            =   True
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   304
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   0
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Test Name"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   245
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   659
      End
      Begin DesktopLabel TestResultLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   975
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   5
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Passed"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   245
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   100
      End
      Begin DesktopLabel TestDurationLabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   1269
         LockBottom      =   False
         LockedInPosition=   False
         LockLeft        =   False
         LockRight       =   True
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   6
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "0s"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   245
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   100
      End
      Begin DesktopTextArea ExpectedOutput
         AllowAutoDeactivate=   True
         AllowFocusRing  =   False
         AllowSpellChecking=   True
         AllowStyledText =   True
         AllowTabs       =   False
         BackgroundColor =   &cFFFFFF
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Format          =   ""
         HasBorder       =   True
         HasHorizontalScrollbar=   False
         HasVerticalScrollbar=   True
         Height          =   318
         HideSelection   =   True
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   306
         LineHeight      =   0.0
         LineSpacing     =   1.0
         LockBottom      =   True
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         MaximumCharactersAllowed=   0
         Multiline       =   True
         ReadOnly        =   True
         Scope           =   0
         TabIndex        =   7
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   ""
         TextAlignment   =   0
         TextColor       =   &c000000
         Tooltip         =   ""
         Top             =   549
         Transparent     =   False
         Underline       =   False
         UnicodeMode     =   1
         ValidationMask  =   ""
         Visible         =   True
         Width           =   525
      End
      Begin DesktopTextArea ActualOutput
         AllowAutoDeactivate=   True
         AllowFocusRing  =   False
         AllowSpellChecking=   True
         AllowStyledText =   True
         AllowTabs       =   False
         BackgroundColor =   &cFFFFFF
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Format          =   ""
         HasBorder       =   True
         HasHorizontalScrollbar=   False
         HasVerticalScrollbar=   True
         Height          =   318
         HideSelection   =   True
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   843
         LineHeight      =   0.0
         LineSpacing     =   1.0
         LockBottom      =   True
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         MaximumCharactersAllowed=   0
         Multiline       =   True
         ReadOnly        =   True
         Scope           =   0
         TabIndex        =   8
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   ""
         TextAlignment   =   0
         TextColor       =   &c000000
         Tooltip         =   ""
         Top             =   549
         Transparent     =   False
         Underline       =   False
         UnicodeMode     =   1
         ValidationMask  =   ""
         Visible         =   True
         Width           =   525
      End
      Begin DesktopLabel LabelExpectedOutput
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   306
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   9
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Expected Output:"
         TextAlignment   =   0
         TextColor       =   &c000000
         Tooltip         =   ""
         Top             =   517
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   141
      End
      Begin DesktopLabel LabelActualOutput
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   843
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   10
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Actual Output:"
         TextAlignment   =   0
         TextColor       =   &c000000
         Tooltip         =   ""
         Top             =   517
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   113
      End
      Begin DesktopTextArea InputMarkdown
         AllowAutoDeactivate=   True
         AllowFocusRing  =   False
         AllowSpellChecking=   True
         AllowStyledText =   True
         AllowTabs       =   False
         BackgroundColor =   &cFFFFFF
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Format          =   ""
         HasBorder       =   True
         HasHorizontalScrollbar=   False
         HasVerticalScrollbar=   True
         Height          =   196
         HideSelection   =   True
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   306
         LineHeight      =   0.0
         LineSpacing     =   1.0
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         MaximumCharactersAllowed=   0
         Multiline       =   True
         ReadOnly        =   True
         Scope           =   0
         TabIndex        =   11
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   ""
         TextAlignment   =   0
         TextColor       =   &c000000
         Tooltip         =   ""
         Top             =   309
         Transparent     =   False
         Underline       =   False
         UnicodeMode     =   1
         ValidationMask  =   ""
         Visible         =   True
         Width           =   525
      End
      Begin DesktopLabel LabelExpectedOutput1
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   24
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   306
         LockBottom      =   False
         LockedInPosition=   True
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   12
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Input Markdown:"
         TextAlignment   =   0
         TextColor       =   &c000000
         Tooltip         =   ""
         Top             =   273
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   141
      End
      Begin DesktopLabel LabelDuration
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "GroupBoxes$1"
         Italic          =   False
         Left            =   1153
         LockBottom      =   False
         LockedInPosition=   False
         LockLeft        =   False
         LockRight       =   True
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   1
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Duration:"
         TextAlignment   =   0
         TextColor       =   &c00000000
         Tooltip         =   ""
         Top             =   245
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   100
      End
   End
   Begin UnitTestingToolbar MyToolbar
      Enabled         =   True
      Index           =   -2147483648
      InitialParent   =   ""
      LockedInPosition=   False
      Scope           =   0
      TabPanelIndex   =   0
      Visible         =   True
   End
   Begin MarkdownTestController Controller
      AllTestCount    =   0
      Duration        =   0.0
      Enabled         =   True
      FailedCount     =   0
      GroupCount      =   0
      Index           =   -2147483648
      IsRunning       =   False
      LockedInPosition=   False
      NotImplementedCount=   0
      PassedCount     =   0
      RunGroupCount   =   0
      RunTestCount    =   0
      Scope           =   2
      SkippedCount    =   0
      TabPanelIndex   =   0
   End
   Begin DesktopProgressWheel ProgressWheel1
      Active          =   False
      AllowAutoDeactivate=   True
      AllowTabStop    =   False
      Enabled         =   True
      Height          =   16
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   1364
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      PanelIndex      =   0
      Scope           =   0
      TabIndex        =   6
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   7
      Transparent     =   False
      Visible         =   False
      Width           =   16
      _mIndex         =   0
      _mInitialParent =   ""
      _mName          =   ""
      _mPanelIndex    =   0
   End
   Begin DesktopListBox TestGroupList
      AllowAutoDeactivate=   True
      AllowAutoHideScrollbars=   True
      AllowExpandableRows=   True
      AllowFocusRing  =   False
      AllowResizableColumns=   False
      AllowRowDragging=   False
      AllowRowReordering=   False
      Bold            =   False
      ColumnCount     =   3
      ColumnWidths    =   "*,55,30"
      DefaultRowHeight=   -1
      DropIndicatorVisible=   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      GridLineStyle   =   0
      HasBorder       =   True
      HasHeader       =   False
      HasHorizontalScrollbar=   False
      HasVerticalScrollbar=   True
      HeadingIndex    =   -1
      Height          =   894
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   ""
      Italic          =   False
      Left            =   0
      LockBottom      =   True
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      RequiresSelection=   False
      RowSelectionType=   0
      Scope           =   0
      TabIndex        =   0
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   0
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   274
      _ScrollOffset   =   0
      _ScrollWidth    =   -1
   End
End
#tag EndDesktopWindow

#tag WindowCode
	#tag Event
		Sub Opening()
		  Controller.LoadTestGroups
		  
		  PopulateTestGroups
		  
		  // Force a resize to accommodate the toolbar.
		  Self.Height = Self.Height
		  
		  Self.Top = Self.Top + 20
		End Sub
	#tag EndEvent

	#tag Event
		Sub Resizing()
		  RepositionControls
		End Sub
	#tag EndEvent


	#tag MenuHandler
		Function EditSelectAllGroups() As Boolean Handles EditSelectAllGroups.Action
			SelectAllGroups(True, False)
			
			Return True
			
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function EditUnselectAllGroups() As Boolean Handles EditUnselectAllGroups.Action
			SelectAllGroups(False, False)
			
			Return True
			
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function FileRunTests() As Boolean Handles FileRunTests.Action
			RunTests
			
			Return True
			
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function HelpAboutXojoUnit() As Boolean Handles HelpAboutXojoUnit.Action
			WinAbout.Show
			
			Return True
			
		End Function
	#tag EndMenuHandler


	#tag Method, Flags = &h0
		Sub ExportTests(filePath As String)
		  Controller.ExportTestResults filePath
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub PopulateTestGroups()
		  // Add the test groups into the listbox
		  TestGroupList.RemoveAllRows
		  
		  For Each g As TestGroup In Controller.TestGroups
		    TestGroupList.AddExpandableRow(g.Name)
		    TestGroupList.CellTypeAt(TestGroupList.LastAddedRowIndex, ColInclude) = DesktopListBox.CellTypes.CheckBox
		    TestGroupList.CellCheckBoxValueAt(TestGroupList.LastAddedRowIndex, ColInclude) = g.IncludeGroup
		    TestGroupList.RowTagAt(TestGroupList.LastAddedRowIndex) = g
		  Next
		  
		  Var testCount As Integer
		  testCount = Controller.AllTestCount
		  TestCountLabel.Text = testCount.ToString + " tests in " + Controller.GroupCount.ToString + " groups"
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21, Description = 5265706F736974696F6E7320616E7920636F6E74726F6C732074686174206172656E2774206D616E61676564206175746F6D61746963616C6C7920627920586F6A6F2E
		Private Sub RepositionControls()
		  /// Repositions any controls that aren't managed automatically by Xojo.
		  
		  Var outputWidth As Integer = (GroupBoxes(0).Width / 2) - 18
		  
		  InputMarkdown.Width = outputWidth
		  
		  ExpectedOutput.Width = outputWidth
		  
		  ActualOutput.Left = (GroupBoxes(0).Left + GroupBoxes(0).Width) - outputWidth - 8
		  ActualOutput.Width = outputWidth
		  
		  LabelActualOutput.Left = ActualOutput.Left
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub ResetTestGroupList()
		  Var lastRow As Integer
		  
		  Var selectedRow As Integer = TestGroupList.SelectedRowIndex
		  Var scroll As Integer = TestGroupList.ScrollPosition
		  
		  lastRow = TestGroupList.RowCount - 1
		  
		  For row As Integer = lastRow DownTo 0
		    If TestGroupList.RowExpandableAt(row) Then
		      TestGroupList.RowExpandedAt(row) = False
		    End If
		  Next
		  
		  lastRow = TestGroupList.RowCount - 1
		  For row As Integer = lastRow DownTo 0
		    Var g As TestGroup = TestGroup(TestGroupList.RowTagAt(row))
		    If g.IncludeGroup Then
		      TestGroupList.RowExpandedAt(row) = True
		    End If
		  Next
		  
		  TestGroupList.SelectedRowIndex = selectedRow
		  TestGroupList.ScrollPosition = scroll
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function RowOfTestGroup(tg As TestGroup) As Integer
		  For row As Integer = 0 To TestGroupList.RowCount - 1
		    If TestGroupList.RowTagAt(row) Is tg Then
		      Return row
		    End If
		  Next
		  
		  Return -1
		  
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function RowOfTestResult(tr As TestResult) As Integer
		  For row As Integer = TestGroupList.RowCount - 1 DownTo 0
		    If TestGroupList.RowTagAt(row) Is tr Then
		      Return row
		    End If
		  Next
		  
		  Return -1
		  
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub RunTests()
		  Var now As DateTime = DateTime.Now
		  
		  StartLabel.Text = now.ToString(DateTime.FormatStyles.Short, DateTime.FormatStyles.Short)
		  
		  ProgressWheel1.Visible = True
		  MyToolbar.RunButton.Enabled = False
		  MyToolbar.RunUntilFailButton.Enabled = False
		  MyToolbar.StopButton.Enabled = True
		  MyToolbar.ExportButton.Enabled = False
		  
		  Controller.Start
		  ResetTestGroupList
		  UpdateSummary
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub SelectAllGroups(value As Boolean, andTests As Boolean)
		  For i As Integer = 0 To TestGroupList.RowCount - 1
		    If TestGroupList.RowTagAt(i) IsA TestGroup Then
		      Var tg As TestGroup
		      tg = TestGroupList.RowTagAt(i)
		      tg.IncludeGroup = value
		      
		      TestGroupList.CellCheckboxValueAt(i, ColInclude) = value
		      
		      If andTests Then
		        SelectAllTests(tg, value)
		      End If
		    End If
		  Next
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub SelectAllTests(tg As TestGroup, value As Boolean)
		  For Each tr As TestResult In tg.Results
		    tr.IncludeMethod = value
		  Next
		  
		  Var tgRow As Integer = RowOfTestGroup(tg)
		  
		  If tgRow <> -1 Then
		    If TestGroupList.RowExpandedAt(tgRow) Then
		      
		      For row As Integer = tgRow + 1 To TestGroupList.RowCount - 1
		        If Not (TestGroupList.RowTagAt(row) IsA TestResult) Then
		          Exit For
		        End If
		        TestGroupList.CellCheckboxValueAt(row, ColInclude) = value
		      Next
		      
		    End If
		  End If
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub SelectInverseGroups(andTests As Boolean)
		  For i As Integer = 0 To TestGroupList.RowCount - 1
		    If TestGroupList.RowTagAt(i) IsA TestGroup Then
		      Var tg As TestGroup = TestGroupList.RowTagAt(i)
		      tg.IncludeGroup = Not tg.IncludeGroup
		      
		      TestGroupList.CellCheckboxValueAt(i, ColInclude) = tg.IncludeGroup
		      
		      If andTests Then
		        SelectInverseTests(tg)
		      End If
		    End If
		  Next
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub SelectInverseTests(tg As TestGroup)
		  For Each tr As TestResult In tg.Results
		    tr.IncludeMethod = Not tr.IncludeMethod
		  Next
		  
		  Var tgRow As Integer = RowOfTestGroup(tg)
		  
		  If tgRow <> -1 And TestGroupList.RowExpandedAt(tgRow) Then
		    
		    For row As Integer = tgRow + 1 To TestGroupList.RowCount - 1
		      Var tag As Variant = TestGroupList.RowTagAt(row)
		      If Not (tag IsA TestResult) Then
		        Exit For
		      End If
		      Var tr As TestResult = tag
		      TestGroupList.CellCheckboxValueAt(row, ColInclude) = tr.IncludeMethod
		    Next
		    
		  End If
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub SelectOneGroup(tg As TestGroup, value As Boolean)
		  tg.IncludeGroup = value
		  TestGroupList.CellCheckboxValueAt(RowOfTestGroup(tg), ColInclude) = tg.IncludeGroup
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub SelectOneTest(tg As TestGroup, tr As TestResult)
		  SelectOneGroup(tg, True)
		  
		  tr.IncludeMethod = True
		  Var row As Integer = RowOfTestResult(tr)
		  If row <> -1 Then
		    TestGroupList.CellCheckboxValueAt(row, ColInclude) = True
		  End If
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub StopTests()
		  If RunUntilFail Then
		    RunUntilFail = False
		  Else
		    Controller.Stop
		  End If
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub TestsFinished()
		  UpdateSummary
		  
		  If RunUntilFail And Controller.FailedCount = 0 Then
		    RunTests
		  Else
		    ProgressWheel1.Visible = False
		    MyToolbar.RunButton.Enabled = True
		    MyToolbar.RunUntilFailButton.Enabled = True
		    MyToolbar.StopButton.Enabled = False
		    MyToolbar.ExportButton.Enabled = True
		  End If
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21, Description = 5265706C616365732073706163657320616E6420746162732077697468696E205B735D20776974682076697369626C6520636861726163746572732E
		Private Function TransformWhitespace(s As String) As String
		  /// Replaces spaces and tabs within [s] with visible characters.
		  
		  Var result As String = s.ReplaceAll(&u0020, "•")
		  result = result.ReplaceAll(&u0009, "→")
		  
		  Return result
		  
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateSummary()
		  DurationLabel.Text = Format(Controller.Duration, "#,###.0000000") + "s"
		  
		  Var allTestCount As Integer = Controller.AllTestCount
		  Var runTestCount As Integer = Controller.RunTestCount
		  
		  Var groupsMessage As String = Controller.RunGroupCount.ToString + If(Controller.RunGroupCount = 1, " group was run", " groups were run")
		  Var testsMessage As String = If(allTestCount = 1, " test", " tests")
		  
		  If runTestCount = allTestCount Then
		    TestCountLabel.Text = runTestCount.ToString + testsMessage + " in " + groupsMessage
		  Else
		    TestCountLabel.Text = runTestCount.ToString + " of " + allTestCount.ToString + testsMessage + " in " + groupsMessage
		  End If
		  
		  Var passedCount As Integer = Controller.PassedCount
		  Var passedPercent As Double = passedCount / runTestCount
		  Var passedPercentMessage As String = If(runTestCount = 0, "", " (" + Format(passedPercent, "#.00%") + ")")
		  
		  Var failedCount As Integer = Controller.FailedCount
		  Var failedPercent As Double = failedCount / runTestCount
		  Var failedPercentMessage As String = If(runTestCount = 0, "", " (" + Format(failedPercent, "#.00%") + ")")
		  
		  PassedCountLabel.Text = passedCount.ToString + passedPercentMessage
		  FailedCountLabel.Text = Controller.FailedCount.ToString + failedPercentMessage
		  SkippedCountLabel.Text = Controller.SkippedCount.ToString
		  NotImplementedCountLabel.Text = Controller.NotImplementedCount.ToString
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateTestResult(tr As TestResult, row As Integer = -1)
		  If row < 0 Then
		    row = RowOfTestResult(tr)
		  End If
		  
		  If row <> -1 Then
		    TestGroupList.CellTextAt(row, ColTestName) = tr.TestName
		    TestGroupList.CellTextAt(row, ColResult) = tr.Result
		    TestGroupList.CellCheckboxValueAt(row, ColInclude) = tr.IncludeMethod
		    
		    If TestGroupList.SelectedRowIndex = row Then
		      UpdateTestSummary
		    End If
		  End If
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateTestResults(tg As TestGroup)
		  TestGroupList.Refresh
		  
		  Var tgRow As Integer = RowOfTestGroup(tg)
		  If tgRow = -1 Then
		    Return
		  End If
		  
		  If TestGroupList.SelectedRowIndex = tgRow Then
		    UpdateTestSummary
		  End If
		  
		  If TestGroupList.RowExpandedAt(tgRow) Then
		    For row As Integer = tgRow + 1 To TestGroupList.RowCount - 1
		      Var tag As Variant = TestGroupList.RowTagAt(row)
		      If Not (tag IsA TestResult) Then
		        //
		        // We have exhausted the group
		        //
		        Return
		      End If
		      
		      UpdateTestResult(TestResult(tag), row)
		    Next
		  End If
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateTestSummary()
		  Var name, result, message, duration, expected, actual, input As String
		  
		  Var item As Variant
		  If TestGroupList.SelectedRowIndex <> -1 Then
		    item = TestGroupList.RowTagAt(TestGroupList.SelectedRowIndex)
		  End If
		  
		  If item IsA TestResult Then
		    Var tr As TestResult = item
		    name = tr.TestName
		    result = tr.Result
		    message = tr.Message
		    duration = Format(tr.Duration, "#,0.0000000") + "s"
		    expected = TestResult(item).Expected
		    actual = TestResult(item).Actual
		    input = TestResult(item).Input
		  ElseIf item IsA TestGroup Then
		    Var tg As TestGroup = item
		    name = tg.Name + " Group"
		    duration = Format(tg.Duration, "#,0.0000000") + "s"
		  End If
		  
		  TestNameLabel.Text = name
		  TestDurationLabel.Text = duration
		  
		  TestResultLabel.Text = result
		  TestResultLabel.TextColor = If(result = "Passed", Color.RGB(78, 143, 0), Color.Red)
		  
		  ExpectedOutput.Text = expected
		  ActualOutput.Text = actual
		  InputMarkdown.Text = TransformWhitespace(input)
		  
		End Sub
	#tag EndMethod


	#tag ComputedProperty, Flags = &h21
		#tag Getter
			Get
			  Return Integer(Columns.Include)
			End Get
		#tag EndGetter
		Private ColInclude As Integer
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h21
		#tag Getter
			Get
			  Return Integer(Columns.Result)
			End Get
		#tag EndGetter
		Private ColResult As Integer
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h21
		#tag Getter
			Get
			  Return Integer(Columns.TestName)
			End Get
		#tag EndGetter
		Private ColTestName As Integer
	#tag EndComputedProperty

	#tag Property, Flags = &h21
		Private RunUntilFail As Boolean
	#tag EndProperty


	#tag Constant, Name = kCMSelectAllGroups, Type = String, Dynamic = False, Default = \"Select All Groups", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMSelectAllGroupsAndTests, Type = String, Dynamic = False, Default = \"Select All Groups && Tests", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMSelectAllTests, Type = String, Dynamic = False, Default = \"Select All Tests In This Group", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMSelectFailedTests, Type = String, Dynamic = False, Default = \"Select Failed Test(s)", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMSelectInverseGroups, Type = String, Dynamic = False, Default = \"Select Inverse Goups", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMSelectInverseGroupsAndTests, Type = String, Dynamic = False, Default = \"Select Inverse Groups && Tests", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMSelectInverseTests, Type = String, Dynamic = False, Default = \"Select Inverse Tests In This Group", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMSelectOneTest, Type = String, Dynamic = False, Default = \"Select This Test Only", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMSelectThisGroup, Type = String, Dynamic = False, Default = \"Select This Group", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMUnselectAllGroups, Type = String, Dynamic = False, Default = \"Unselect All Groups", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMUnselectAllGroupsAndTests, Type = String, Dynamic = False, Default = \"Unselect All Groups && Tests", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMUnselectAllTests, Type = String, Dynamic = False, Default = \"Unselect All Tests In This Group", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kCMUnselectThisGroup, Type = String, Dynamic = False, Default = \"Unselect This Group", Scope = Private
	#tag EndConstant


	#tag Enum, Name = Columns, Type = Integer, Flags = &h21
		TestName
		  Result
		Include
	#tag EndEnum


#tag EndWindowCode

#tag Events MyToolbar
	#tag Event
		Sub Pressed(item As DesktopToolbarItem)
		  Select Case item
		  Case MyToolbar.RunButton
		    RunUntilFail = False
		    RunTests
		    
		  Case MyToolbar.RunUntilFailButton
		    RunUntilFail = True
		    RunTests
		    
		  Case MyToolbar.StopButton
		    StopTests
		    
		  Case MyToolbar.ExportButton
		    Var dlg As New SaveFileDialog
		    Var f As FolderItem
		    dlg.InitialFolder = SpecialFolder.Documents
		    dlg.promptText = "Save results as"
		    dlg.SuggestedFileName = "results.xml"
		    dlg.Title = "Save Results"
		    dlg.Filter = "xml"
		    f = dlg.ShowModal()
		    If f <> Nil Then
		      ExportTests f.NativePath
		    End If
		    
		  End Select
		End Sub
	#tag EndEvent
	#tag Event
		Sub Opening()
		  Me.RunButton.Enabled = True
		  Me.StopButton.Enabled = False
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Controller
	#tag Event
		Sub AllTestsFinished()
		  TestsFinished()
		  
		End Sub
	#tag EndEvent
	#tag Event
		Sub TestFinished(result As TestResult, group As TestGroup)
		  #Pragma Unused group
		  
		  UpdateTestResult(result)
		End Sub
	#tag EndEvent
	#tag Event
		Sub GroupFinished(group As TestGroup)
		  /// A final update in case something changed after the test ran.
		  
		  UpdateTestResults(group)
		  UpdateSummary
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events TestGroupList
	#tag Event
		Sub RowExpanded(row As Integer)
		  Var g As TestGroup
		  g = Me.RowTagAt(row)
		  
		  If g <> Nil Then
		    For Each result As TestResult In g.Results
		      Me.AddRow("")
		      Me.ColumnTypeAt(ColInclude) = DesktopListBox.CellTypes.CheckBox
		      Me.RowTagAt(Me.LastAddedRowIndex) = result
		      
		      UpdateTestResult(result, Me.LastAddedRowIndex)
		    Next
		  End If
		End Sub
	#tag EndEvent
	#tag Event
		Sub SelectionChanged()
		  UpdateTestSummary
		End Sub
	#tag EndEvent
	#tag Event
		Sub DoublePressed()
		  Me.RowExpandedAt(Me.SelectedRowIndex) = Not Me.RowExpandedAt(Me.SelectedRowIndex)
		End Sub
	#tag EndEvent
	#tag Event
		Sub CellAction(row As Integer, column As Integer)
		  If column = ColInclude Then
		    
		    Select Case Me.RowTagAt(row)
		    Case IsA TestGroup
		      Var tg As TestGroup = Me.RowTagAt(row)
		      tg.IncludeGroup = Me.CellCheckboxValueAt(row, column)
		      
		    Case IsA TestResult
		      Var tr As TestResult = Me.RowTagAt(row)
		      tr.IncludeMethod = Me.CellCheckboxValueAt(row, column)
		      
		    End Select
		  End If
		End Sub
	#tag EndEvent
	#tag Event
		Function PaintCellBackground(g As Graphics, row As Integer, column As Integer) As Boolean
		  #Pragma Unused column
		  
		  #If TargetMacOS Then
		    If row Mod 2 = 0 And Not Me.RowSelectedAt(row) Then
		      g.DrawingColor = Color.RGB(237, 243, 254) '&cD0D4FF
		      g.FillRectangle(0, 0, g.Width, g.Height)
		    End If
		    
		    Return True
		  #Else
		    #Pragma Unused g
		    #Pragma Unused row
		  #Endif
		  
		End Function
	#tag EndEvent
	#tag Event
		Function ContextualMenuItemSelected(selectedItem As DesktopMenuItem) As Boolean
		  Select Case selectedItem.Text
		  Case kCMSelectAllGroups
		    SelectAllGroups(True, False)
		    
		  Case kCMUnselectAllGroups
		    SelectAllGroups(False, False)
		    
		  Case kCMSelectInverseGroups
		    SelectInverseGroups(False)
		    
		  Case kCMSelectFailedTests
		    SelectAllGroups(False, True)
		    
		    For Each tg As TestGroup In Controller.TestGroups
		      For Each tr As TestResult In tg.Results
		        If tr.Result = TestResult.Failed Then
		          SelectOneTest(tg, tr)
		        End If
		      Next
		    Next
		    
		  Case kCMSelectAllTests
		    SelectAllTests(selectedItem.Tag, True)
		    
		  Case kCMSelectInverseTests
		    SelectInverseTests(selectedItem.Tag)
		    
		  Case kCMUnselectAllTests
		    SelectAllTests(selectedItem.Tag, False)
		    
		  Case kCMSelectOneTest
		    Var tag As Pair = selectedItem.Tag
		    Var tg As TestGroup = tag.Left
		    Var tr As TestResult = tag.Right
		    SelectAllGroups(False, True)
		    SelectOneTest(tg, tr)
		    
		  Case kCMSelectThisGroup
		    Var tg As TestGroup = selectedItem.Tag
		    SelectOneGroup(tg, True)
		    
		  Case kCMUnselectThisGroup
		    Var tg As TestGroup = selectedItem.Tag
		    SelectOneGroup(tg, False)
		    
		  Case kCMSelectAllGroupsAndTests
		    SelectAllGroups(True, True)
		    
		  Case kCMUnselectAllGroupsAndTests
		    SelectAllGroups(False, True)
		    
		  Case kCMSelectInverseGroupsAndTests
		    SelectInverseGroups(True)
		    
		  Case "Select Errors"
		    
		    
		  End Select
		End Function
	#tag EndEvent
	#tag Event
		Function ConstructContextualMenu(base As DesktopMenuItem, x As Integer, y As Integer) As Boolean
		  #Pragma Unused x
		  #Pragma Unused y
		  
		  base.AddMenu(New MenuItem(kCMSelectAllGroups))
		  base.AddMenu(New MenuItem(kCMSelectInverseGroups))
		  base.AddMenu(New MenuItem(kCMUnselectAllGroups))
		  
		  If Controller.FailedCount <> 0 Then
		    base.AddMenu(New MenuItem(MenuItem.TextSeparator))
		    
		    base.AddMenu(New MenuItem(kCMSelectFailedTests))
		  End If
		  
		  If Me.SelectedRowIndex <> -1 Then
		    Var tg As TestGroup
		    For row As Integer = Me.SelectedRowIndex DownTo 0
		      If Me.RowTagAt(row) IsA TestGroup Then
		        tg = Me.RowTagAt(row)
		        Exit For row
		      End If
		    Next
		    
		    Var tr As TestResult = _
		    If(Me.RowTagAt(Me.SelectedRowIndex) IsA TestResult, TestResult(Me.RowTagAt(Me.SelectedRowIndex)), Nil)
		    
		    base.AddMenu(New MenuItem(MenuItem.TextSeparator))
		    
		    base.AddMenu(New MenuItem(kCMSelectAllTests, tg))
		    base.AddMenu(New MenuItem(kCMSelectInverseTests, tg))
		    base.AddMenu(New MenuItem(kCMUnselectAllTests, tg))
		    
		    base.AddMenu(New MenuItem(MenuItem.TextSeparator))
		    
		    If tr IsA TestResult Then
		      base.AddMenu(New MenuItem(kCMSelectOneTest, tg : tr))
		      
		      base.AddMenu(New MenuItem(MenuItem.TextSeparator))
		    End If
		    
		    base.AddMenu(New MenuItem(kCMSelectThisGroup, tg))
		    base.AddMenu(New MenuItem(kCMUnselectThisGroup, tg))
		  End If
		  
		  base.AddMenu(New MenuItem(MenuItem.TextSeparator))
		  
		  base.AddMenu(New MenuItem(kCMSelectAllGroupsAndTests))
		  base.AddMenu(New MenuItem(kCMSelectInverseGroupsAndTests))
		  base.AddMenu(New MenuItem(kCMUnselectAllGroupsAndTests))
		  
		  Return True
		End Function
	#tag EndEvent
	#tag Event
		Function PaintCellText(g as Graphics, row as Integer, column as Integer, x as Integer, y as Integer) As Boolean
		  #Pragma Unused column
		  #Pragma Unused x
		  #Pragma Unused y
		  
		  Const kRedColor As Color = &cFF000000
		  Const kBlackColor As Color = &c00000000
		  Static kGreyColor As Color = Color.DisabledTextColor // Pseudo-constant
		  
		  If Me.RowTagAt(row) IsA TestResult Then
		    
		    Var tr As TestResult = Me.RowTagAt(row)
		    
		    If tr.Result = TestResult.Failed Then
		      g.DrawingColor = kRedColor
		      g.Bold = True
		      
		    Else
		      If tr.Result = TestResult.NotImplemented Then
		        g.DrawingColor = kGreyColor
		      Else
		        g.DrawingColor = kBlackColor
		      End If
		      g.Bold = Not tr.Message.IsEmpty
		      
		    End If
		    
		  End If
		  
		End Function
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="MinimumWidth"
		Visible=true
		Group="Size"
		InitialValue="64"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinimumHeight"
		Visible=true
		Group="Size"
		InitialValue="64"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaximumWidth"
		Visible=true
		Group="Size"
		InitialValue="32000"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaximumHeight"
		Visible=true
		Group="Size"
		InitialValue="32000"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Type"
		Visible=true
		Group="Frame"
		InitialValue="0"
		Type="Types"
		EditorType="Enum"
		#tag EnumValues
			"0 - Document"
			"1 - Movable Modal"
			"2 - Modal Dialog"
			"3 - Floating Window"
			"4 - Plain Box"
			"5 - Shadowed Box"
			"6 - Rounded Window"
			"7 - Global Floating Window"
			"8 - Sheet Window"
			"9 - Metal Window"
			"11 - Modeless Dialog"
		#tag EndEnumValues
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasCloseButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasMaximizeButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasMinimizeButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasFullScreenButton"
		Visible=true
		Group="Frame"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="DefaultLocation"
		Visible=true
		Group="Behavior"
		InitialValue="0"
		Type="Locations"
		EditorType="Enum"
		#tag EnumValues
			"0 - Default"
			"1 - Parent Window"
			"2 - Main Screen"
			"3 - Parent Window Screen"
			"4 - Stagger"
		#tag EndEnumValues
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="BackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="&hFFFFFF"
		Type="ColorGroup"
		EditorType="ColorGroup"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Appearance"
		InitialValue=""
		Type="Picture"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Composite"
		Visible=true
		Group="Appearance"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="FullScreen"
		Visible=true
		Group="Appearance"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Position"
		InitialValue="400"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="ImplicitInstance"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Interfaces"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MacProcID"
		Visible=true
		Group="Appearance"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MenuBar"
		Visible=true
		Group="Appearance"
		InitialValue=""
		Type="DesktopMenuBar"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MenuBarVisible"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Resizeable"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Title"
		Visible=true
		Group="Appearance"
		InitialValue="Untitled"
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Position"
		InitialValue="600"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
#tag EndViewBehavior
